% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/panel.R
\name{generate_advanced_panel}
\alias{generate_advanced_panel}
\title{Advanced Analysis Panel (rank/occupancy/SAR/decay/rarefaction + optional PPC)}
\usage{
generate_advanced_panel(res)
}
\arguments{
\item{res}{A list produced by the main simulator containing at least:
\describe{
\item{\code{P}}{Parameter list (used for labels/themes if needed).}
\item{\code{species_dist}}{An \code{sf} POINT layer of individuals with a \code{species} column.}
\item{\code{abund_matrix}}{Site \eqn{\times} species abundance data frame (first column \code{site}).}
\item{\code{site_coords}}{Data frame with \code{site, x, y} for quadrat centroids.}
\item{\code{domain}}{An \code{sf} polygon/multipolygon of the study area (used for PPC window).}
}}
}
\value{
A \code{patchwork} object (a \code{ggplot} layout). You can print it
or save it with \code{ggplot2::ggsave()}.
}
\description{
Build a multi‑panel summary of key ecological diagnostics from a simulation
run: rank–abundance (SAD), occupancy–abundance, species–area (accumulation),
distance–decay, and per‑quadrat rarefaction curves. If the point‑process
packages \pkg{spatstat.geom} and \pkg{spatstat.explore} are available, an
additional row of \strong{point–process diagnostics} is appended, showing
Ripley’s K (border correction), \eqn{L(r)-r}, and the pair‑correlation
function \eqn{g(r)}.
}
\details{
The optional point–process diagnostics are computed only when both
\pkg{spatstat.geom} (for spatial windows and point patterns) and
\pkg{spatstat.explore} (for summary functions such as \code{Kest} and
\code{pcf}) are installed. The domain is converted to a window (\code{owin})
using \code{spatstat.geom::as.owin()} on the \code{sf} polygon; the
individuals are converted to a \code{ppp} with that window. We then compute:
\itemize{
\item \code{Kest(ppp, correction = "border")} and plot the border‑corrected K.
\item \eqn{L(r) = \sqrt{K(r)/\pi}} and \eqn{L(r)-r} (\eqn{>0} suggests clustering).
\item \code{pcf(ppp)} as an estimate of the pair‑correlation \eqn{g(r)}
(\eqn{>1} suggests clustering; \eqn{<1} inhibition).
}
If conversion to \code{owin}/\code{ppp} fails, the PPC row is omitted gracefully.
}
\examples{
\dontrun{
panel <- generate_advanced_panel(results_list)
ggplot2::ggsave("advanced_panel.png", panel, width = 12, height = 14, dpi = 300)
}
}
\seealso{
\code{\link{calculate_rank_abundance}}, \code{\link{plot_rank_abundance}},
\code{\link{calculate_occupancy_abundance}}, \code{\link{plot_occupancy_abundance}},
\code{\link{calculate_species_area}}, \code{\link{plot_species_area}},
\code{\link{calculate_distance_decay}}, \code{\link{plot_distance_decay}},
\code{\link{calculate_rarefaction}}, \code{\link{plot_rarefaction}}
}
