% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/abundance.R
\name{generate_fisher_log_series}
\alias{generate_fisher_log_series}
\title{Generate Fisher's log-series abundances with a dominant species}
\usage{
generate_fisher_log_series(
  n_species,
  n_individuals,
  dominant_fraction,
  alpha,
  x
)
}
\arguments{
\item{n_species}{Integer (>= 1). Total number of species.}

\item{n_individuals}{Integer (>= 1). Total number of individuals to allocate.}

\item{dominant_fraction}{Numeric in \eqn{[0,1]}. Fraction of individuals assigned to
species \code{"A"}; the remainder are split among species \code{"B"} ... according to
the log-series.}

\item{alpha}{Numeric (> 0). Fisher's \eqn{\alpha} parameter controlling tail weight.}

\item{x}{Numeric, typically close to 1. The log-series scaling parameter.}
}
\value{
A named numeric vector of integer abundances whose names are \code{"A"}, \code{"B"},
\code{"C"}, ... up to \code{n_species}. The vector sums to \code{n_individuals}.
}
\description{
Creates a rank-abundance vector for \emph{S} species following Fisher's
log-series, while allocating a fixed fraction of individuals to a single
dominant species ("A"). The remaining individuals are distributed across
species B... in decreasing expectation \eqn{\propto \alpha x^{r} / r},
where \eqn{r = 2, \ldots, S}.
}
\details{
The algorithm:
\enumerate{
\item Reserves \code{round(n_individuals * dominant_fraction)} individuals for
species \code{"A"}.
\item Computes relative expectations for ranks \code{2:n_species} using
\eqn{\alpha x^{r} / r} and scales them to the remaining individuals.
\item Rounds to integers and adjusts the second species (if present) so that
the final sum equals \code{n_individuals}.
\item Names the vector with \code{LETTERS[1:n_species]} and drops any
species whose rounded abundance is \code{0}.
}
}
\note{
Rounding may produce zeros for some tail species; these are omitted from the
return value. If you need a fixed-length vector including zeros, reindex
against \code{LETTERS[1:n_species]} after the call.
}
\examples{
abund <- generate_fisher_log_series(
  n_species = 10, n_individuals = 1000,
  dominant_fraction = 0.3, alpha = 3, x = 0.95
)
sum(abund) # 1000

}
\seealso{
\code{\link{generate_heterogeneous_distribution}}
}
