<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Voronoi‑based Quadrat Placement — place_quadrats_voronoi • spesim</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Voronoi‑based Quadrat Placement — place_quadrats_voronoi"><meta name="description" content="Places rectangular quadrats by first generating a dense set of random seed
points inside the domain, computing the Voronoi tessellation, and then
identifying those Voronoi cells whose largest inscribed circle is big
enough to contain the requested quadrat (by diagonal). For each suitable
cell, the quadrat is placed at the cell’s “pole of inaccessibility”
(center of the inscribed circle), which tends to yield well‑spaced sampling
locations even in irregular polygons."><meta property="og:description" content="Places rectangular quadrats by first generating a dense set of random seed
points inside the domain, computing the Voronoi tessellation, and then
identifying those Voronoi cells whose largest inscribed circle is big
enough to contain the requested quadrat (by diagonal). For each suitable
cell, the quadrat is placed at the cell’s “pole of inaccessibility”
(center of the inscribed circle), which tends to yield well‑spaced sampling
locations even in irregular polygons."></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">spesim</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.2.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/spesim-advanced-panel.html">Inside the Advanced Analysis Panel</a></li>
    <li><a class="dropdown-item" href="../articles/spesim-env-gradients.html">Simulating Environmental Gradients with spesim</a></li>
    <li><a class="dropdown-item" href="../articles/spesim-init-parameters.html">spesim: Full Init File Parameters</a></li>
    <li><a class="dropdown-item" href="../articles/spesim-interactions.html">spesim: Defining Interspecific Interactions</a></li>
    <li><a class="dropdown-item" href="../articles/spesim-point-processes.html">Point Processes in spesim: Options and Intuition</a></li>
  </ul></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/ajsmit/spesim/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Voronoi‑based Quadrat Placement</h1>
      <small class="dont-index">Source: <a href="https://github.com/ajsmit/spesim/blob/main/R/quadrats_voronoi.R" class="external-link"><code>R/quadrats_voronoi.R</code></a></small>
      <div class="d-none name"><code>place_quadrats_voronoi.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Places rectangular quadrats by first generating a dense set of random seed
points inside the domain, computing the Voronoi tessellation, and then
identifying those Voronoi cells whose largest inscribed circle is big
enough to contain the requested quadrat (by diagonal). For each suitable
cell, the quadrat is placed at the cell’s “pole of inaccessibility”
(center of the inscribed circle), which tends to yield well‑spaced sampling
locations even in irregular polygons.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">place_quadrats_voronoi</span><span class="op">(</span><span class="va">domain</span>, <span class="va">n_quadrats</span>, <span class="va">quadrat_size</span>, <span class="va">voronoi_seed_factor</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-domain">domain<a class="anchor" aria-label="anchor" href="#arg-domain"></a></dt>
<dd><p>An sf polygon/multipolygon defining the sampling
region. Must carry a valid projected CRS suitable for linear measurements.</p></dd>


<dt id="arg-n-quadrats">n_quadrats<a class="anchor" aria-label="anchor" href="#arg-n-quadrats"></a></dt>
<dd><p>Integer (≥1). Target number of quadrats to place.
The actual number returned may be smaller if the domain cannot accommodate
enough suitable Voronoi cells.</p></dd>


<dt id="arg-quadrat-size">quadrat_size<a class="anchor" aria-label="anchor" href="#arg-quadrat-size"></a></dt>
<dd><p>Numeric vector of length 2, c(width, height), giving
quadrat dimensions in the same linear units as domain (e.g., meters).
Both values must be positive and finite.</p></dd>


<dt id="arg-voronoi-seed-factor">voronoi_seed_factor<a class="anchor" aria-label="anchor" href="#arg-voronoi-seed-factor"></a></dt>
<dd><p>Numeric (≥1 recommended). Multiplier controlling
how many random seeds are used to build the Voronoi diagram:
n_seeds = n_quadrats * voronoi_seed_factor. Use larger values (e.g., 8–20)
in very irregular or narrow domains to improve coverage.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>An sf object (polygons) with:</p><dl><dt>quadrat_id</dt>
<dd><p>Sequential integer identifier of the placed quadrats.</p></dd>

<dt>geometry</dt>
<dd><p>Axis‑aligned rectangular polygon for each quadrat.</p></dd>


</dl></div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>

<ul><li><p>The function assumes a projected (planar) CRS for domain so that
distances/areas are in linear units. If your data are in longitude/latitude,
reproject (e.g., to UTM) before calling.</p></li>
<li><p>The number of initial seeds is n_quadrats * voronoi_seed_factor. Larger
values explore the domain more densely and typically find more suitable
cells, at the cost of extra computation.</p></li>
<li><p>Suitability is decided by comparing each cell’s inscribed‑circle radius
to half the requested quadrat diagonal:
radius &gt;= sqrt(width^2 + height^2) / 2.</p></li>
<li><p>If fewer than n_quadrats suitable cells exist, all suitable cells are
used and a warning is issued.</p></li>
<li><p>Quadrats are axis‑aligned rectangles centered at the selected cell
centers. Because the cell centers can be near each other, axis‑aligned
rectangles may still overlap slightly in tight spaces—even when circles
do not. If strict non‑overlap is required, post‑filtering is recommended.</p></li>
<li><p>Internally uses sf::st_voronoi() for tessellation and
st_inscribed_circle() (provided by lwgeom) to compute maximal
in‑circle centers/radii.</p></li>
</ul></div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p><code><a href="place_quadrats.html">place_quadrats</a></code> (random, non‑overlapping),
<code><a href="place_quadrats_tiled.html">place_quadrats_tiled</a></code> (systematic tiling),
<code><a href="place_quadrats_systematic.html">place_quadrats_systematic</a></code> (grid centers within domain),
<code><a href="place_quadrats_transect.html">place_quadrats_transect</a></code> (parallel transects)</p></div>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>

    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by AJ Smit.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer></div>





  </body></html>

